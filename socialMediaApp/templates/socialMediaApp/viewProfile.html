{% extends 'socialMediaApp/base.html' %}
{% load timeProcess %}

{% block title %}
    Profile
{% endblock %}

{% block nav %}
    <ul>
        <li><a href="{% url 'signUp' %}">Sign Up</a></li>
        <li><a href="{% url 'logIn' %}">Log In</a></li>
    </ul>
{% endblock %}

{% block sidebar %}
    <ul>
        <li>
            <a href="{% url 'profile' foreignUser_pk %}">Back to your profile</a>
        </li>
        <li>
            <a href="{% url 'userFollow' foreignUser_pk object.pk %}">{{ followText }}</a>
        </li>
    </ul>
{% endblock %}

{% block body %}
    <div class="profile">
        <h1>{{ object.djangoUser.username }} Profile</h1>
        {% if post_list|length > 0 %}
            <h2>Posts {{ post_list|length }} :</h2>
            <ul>
                {% for post in post_list %}
                    <li>
                        <a href="{% url 'viewPostDetail' foreignUser_pk object.pk post.pk %}">
                            {{ post.title }}
                        </a>
                        {% timeProcess post.date %}
                    </li>
                {% endfor %}
            </ul>
        {% else %}
            <h2>There is no post</h2>
        {% endif %}
        <h1>First Name: </h1>
        <p>{{ object.firstName }}</p>
        <h1>Last Name: </h1>
        <p>{{ object.lastName }}</p>
        <h1>Gender: </h1>
        <p>{{ object.gender }}</p>
        <h1>Bio: </h1>
        <p>{{ object.bio }}</p>
        <h1>Website: </h1>
        <p>{{ object.website }}</p>
    </div>

    <div class="follow">
        <div>
            <h2>Following: </h2>
            {% if followedUsers|length == 0 %}
                <p>This user doesnt' follow any user</p>
            {% else %}
            {% for followedUser in followedUsers %}
                <h3>
                    <a href="{% url 'viewProfile' foreignUser_pk followedUser.following.pk %}">
                        {{ followedUser.following }}
                    </a>
                </h3>
                <ul>
                    {% if followedUser.following.post_set.all|length > 0 %}
                        {% for post in followedUser.following.post_set.all %}
                            <li>
                                <a href="{% url 'viewPostDetail' foreignUser_pk followedUser.following.pk post.pk %}">
                                    {{ post.title }}
                                </a>
                                <br/>
                                <a href="{% url 'viewPostDetail' foreignUser_pk followedUser.following.pk post.pk %}">
                                    <button>Comment</button>
                                </a>
                                <a href="{% url 'postLike' foreignUser_pk post.pk %}">
                                    <button>Like {{ post.likes_count }}</button>
                                </a>
                            </li>
                        {% endfor %}
                    {% else %}
                        <li>This user have no post.</li>
                    {% endif %}
                </ul>
            {% endfor %}
            {% endif %}
        </div>
        <div>
            <h2>Followers: </h2>
            {% if userFollowers|length == 0 %}
                <p>This user doesn't have any followers</p>
            {% else %}
                {% for userFollower in userFollowers %}
                    <h3>
                        <a href="{% url 'viewProfile' foreignUser_pk userFollower.user.pk %}">
                            {{ userFollower.user }}
                        </a>
                    </h3>
                    <ul>
                        {% if userFollower.user.post_set.all|length > 0 %}
                            {% for post in userFollower.user.post_set.all %}
                                <li>
                                    <a href="{% url 'viewPostDetail' foreignUser_pk userFollower.user.pk post.pk %}">
                                        {{ post.title }}
                                    </a>
                                    <br/>
                                    <a href="{% url 'viewPostDetail' foreignUser_pk userFollower.user.pk post.pk %}">
                                        <button>Comment</button>
                                    </a>
                                    <a href="{% url 'postLike' foreignUser_pk post.pk %}">
                                        <button>Like {{ post.likes_count }}</button>
                                    </a>
                                </li>
                            {% endfor %}
                        {% else %}
                            <li>This user have no post.</li>
                        {% endif %}
                    </ul>
                {% endfor %}
            {% endif %}
        </div>
    </div>
{% endblock %}
